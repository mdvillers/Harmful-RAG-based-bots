"""
{"asin": "B0000512IE", "questions": [{"questionType": "open-ended", "askerID": "A39TQ7XW6P36BU", "questionTime": "June 29, 2014", "questionText": "Can I use these with Window 8/8.1?", "answers": [{"answerText": "Yes, you will need to go to their website to download version 4.55 or above of the CH Control Manager program, then you'll be all set. Find it here: http://www.chproducts.com/13-29170-Downloads-and-Community.php", "answererID": "AH14F9TYDABNH", "answerTime": "June 29, 2014", "helpful": [2, 2]}, {"answerText": "Sure can. My Windows 8.1 machine automatically detected the appropriate drivers and installed them for me.", "answererID": "A36BQQD67VJOD2", "answerTime": "June 29, 2014", "helpful": [2, 2]}, {"answerText": "Mine work with W8, can't answer for W8.1 but since it does not require drivers or cd's to be recognized or initialized, I believe it may work. It is truly plug and play!", "answererID": "AZY7TFN31JV8M", "answerTime": "June 29, 2014", "helpful": [1, 1]}, {"answerText": "Yes. I installed on windows 8 and had no problems", "answererID": "A1RU4ZCFMLYY9E", "answerTime": "June 29, 2014", "helpful": [1, 1]}, {"answerText": "I don't see why not. I don't use the CH driver cd that come with it as it tends to cause controller issues. I have Win7x64 and no problems in FSX", "answererID": "A223O8W9Q7VLAE", "answerTime": "June 29, 2014", "helpful": [0, 1]}]}, {"questionType": "open-ended", "askerID": "AL82696CUTIL5", "questionTime": "August 27, 2014", "questionText": "Could this be adapted to be used in racing games also?", "answers": [{"answerText": "I googled the question and found many forums of users using both the CH yoke and pedals for racing games. So yes they can be use for racing. - Dave", "answererID": "AG8XZT4PKY7UZ", "answerTime": "August 28, 2014", "helpful": [0, 0]}, {"answerText": "I've always been under the impression you could use the pedals for racing games, but I only use them for flying.", "answererID": "A261POEFLJDN6L", "answerTime": "August 28, 2014", "helpful": [0, 0]}, {"answerText": "Yes I would think so.", "answererID": "AHGOG7QAAE3XP", "answerTime": "August 28, 2014", "helpful": [0, 0]}, {"answerText": "tes... they come with a adapter that prevents the pedals from moving back and forth allowing you to use the toe brakes as a gas/brake pedals", "answererID": "A315KC8VAO3DFL", "answerTime": "August 28, 2014", "helpful": [0, 0]}]}, {"questionType": "open-ended", "askerID": "A3BTBIV6N9BZFR", "questionTime": "December 20, 2014", "questionText": "How far are the pedals apart? i.e. the spacing distance.", "answers": [{"answerText": "4 inches. They are also at an awkward angle which is quite tasking during extended sessions.", "answererID": "A27XAOZUIWZKW2", "answerTime": "December 20, 2014", "helpful": [2, 2]}, {"answerText": "the space between the pedals is 9.5cm. the width of each pedal is 10.5cm. personally i wish they were further apart but that can be overcome through simple mods. using a wood overlay that extends the pedal sideways.", "answererID": "A3PTUTQV27H4SW", "answerTime": "December 20, 2014", "helpful": [2, 2]}, {"answerText": "Sam: Each pedal is 4\" wide and about 8.5-9\" long. The center of the left pedal to the center of the right pedal is 8\" I have used these pedals for years. They do very well, and are quite sturdy. They have one problem that occurred with one set I had, after several years of use. One of the fine wires inside that moves as the pedals move broke. I thought I would be smart and fix it myself. Big Mistake. These units MUST BE PUT TOGETHER AT THE FACTORY. They are loaded with springs inside, and the Factory has a special tool to dissemble and reassemble them. The cost to repair a unit is almost as much as a new set of rudders, if that should ever happen. All in all they are a good unit and I am on my third set as I have a dual control Microsoft Flight Simulator setup which uses two sets of rudders........Hope that helps......SHALOM, Brother Randahl\n\n\n\n    Sam: Each pedal is 4\" wide and about 8.5-9\" long. The center of the left pedal to the center of the right pedal is 8\" I have used these pedals for years. They do very well, and are quite sturdy. They have one problem that occurred with one set I had, after several years of use. One of the fine wires inside that moves as the pedals move broke. I thought I would be smart and fix it myself. Big Mistake. These units MUST BE PUT TOGETHER AT THE FACTORY. They are loaded with springs inside, and the Factory has a special tool to dissemble and reassemble them. The cost to repair a...\n      \u00bb \nRead More\n\n\n   Sam: Each pedal is 4\" wide and about 8.5-9\" long. The center of the left pedal to the center of the right pedal is 8\" I have used these pedals for years. They do very well, and are quite sturdy. They have one problem that occurred with one set I had, after several years of use. One of the fine wires inside that moves as the pedals move broke. I thought I would be smart and fix it myself. Big Mistake. These units MUST BE PUT TOGETHER AT THE FACTORY. They are loaded with springs inside, and the Factory has a special tool to dissemble and reassemble them. The cost to repair a unit is almost as much as a new set of rudders, if that should ever happen. All in all they are a good unit and I am on my third set as I have a dual control Microsoft Flight Simulator setup which uses two sets of rudders........Hope that helps......SHALOM, Brother Randahl\n      \u00ab \n\nShow Less", "answererID": "A3VYCWBO41LI0R", "answerTime": "December 20, 2014", "helpful": [1, 1]}, {"answerText": "It's 95 mm (3,74 in.)between inner side of pedals, that is #103mm (4,05 in) between inner side of your soles.", "answererID": "A16DU6Q3FA6PBF", "answerTime": "December 21, 2014", "helpful": [1, 1]}, {"answerText": "21,5cm from center of pedal to center of pedal.", "answererID": "A2OGW5CH4V23F3", "answerTime": "December 21, 2014", "helpful": [1, 1]}, {"answerText": "The pedals  are spaced 4 inches apart", "answererID": "A140LX2YHJJDQ5", "answerTime": "December 21, 2014", "helpful": [1, 1]}, {"answerText": "4\" I'm using this pair for 737ng flight simulator project", "answererID": "A2QLHEV1VLJ5OU", "answerTime": "December 23, 2014", "helpful": [0, 1]}]}, {"questionType": "open-ended", "askerID": "AC47IZ66LGSVP", "questionTime": "March 2, 2015", "questionText": "Is there any adjustment in sensitivity of the toe and heel positions.  I have a model PPU995 which has no null position.", "answers": [{"answerText": "I don't think so.  My son and husband use this for flight simulator and they seem pleased with it.", "answererID": "A3895QJD59SRQ8", "answerTime": "March 2, 2015", "helpful": [1, 1]}, {"answerText": "No mechanical adjustment, you can set sensitivity with the in game software!BillH", "answererID": "A3R1Y4GL2QKK8", "answerTime": "March 2, 2015", "helpful": [1, 1]}, {"answerText": "Sensitivity is adjusted in the software.  There are no mechanical tension wheels for this device.  It sits in a natural body position with heels and foot strike normal.  You may need an adjustable chair to get the most comfortable position.  Toe break and rudder effects are all done within the software.  Plenty of travel to allow as much null space and sensitivity for your selection of games.", "answererID": "A1BQCY16FWBTHK", "answerTime": "March 3, 2015", "helpful": [1, 1]}]}, {"questionType": "yes/no", "askerID": "A1YV50YXZOL3EL", "questionTime": "February 3, 2015", "questionText": "does anyone use them for Star Citizen, and if so how would you rate their preference?", "answers": [{"answerText": "Yep. They're a bit small and certainly take some getting used to but they're accurate and work very well once you get them setup properly within the game. I use them for roll and use the xml route to set bindings which is a bit more complex than the in-game interface but it's more fully featured. 1 to 10, I'd give them a 6 or 7. There is much much better, but not for around a hundred bucks. Saitek's pedals are good too but they don't integrate with CH software which is one huge bonus for the whole CH line of gear.Good luck and see you in the verse.", "answererID": "A3GSJ7UQH359Q1", "answerTime": "February 3, 2015", "helpful": [1, 1], "answerType": "?", "answerScore": "0.5472"}, {"answerText": "I use them for both Star Citizen and Elite:Dangerous.  I really like them.  Sturdy, responsive and a good firm center detent that you can feel easily.  They do work well with shoes on, but to me are more comfortable with sock on.", "answererID": "A227Z9QZHMJZ3E", "answerTime": "February 21, 2015", "helpful": [0, 0], "answerType": "?", "answerScore": "0.8723"}]}, {"questionType": "yes/no", "askerID": "A2FCFBKGA3MS5Y", "questionTime": "February 19, 2015", "questionText": "I don't need 7 feet of USB cable.  If I replaced the cable with a different, shorter one, would the pedals still work?", "answers": [{"answerText": "No.  The cable is hard-wired into the pedal base.  The wires are very delicate, and would be difficult to reattach.  It'd void the warranty.  They are great pedals.  I'd just coil up the excess cable and secure it with tape or a zip tie.", "answererID": "A2TQ0T82YWL1HR", "answerTime": "February 19, 2015", "helpful": [0, 0], "answerType": "?", "answerScore": "0.2994"}, {"answerText": "7 feet is not really too much, depends where your USB plugin is and your position, legs length etc", "answererID": "A16DU6Q3FA6PBF", "answerTime": "February 19, 2015", "helpful": [0, 0], "answerType": "?", "answerScore": "0.3206"}, {"answerText": "Yes", "answererID": "A2SSDJ77GGT3YG", "answerTime": "February 19, 2015", "helpful": [0, 0], "answerType": "Y", "answerScore": "0.9814"}, {"answerText": "You can't easily replace the USB Cable, and I'm sure doing so would void the warranty. Why don't you simply tie up the extra cable with a zip tie or simple twist tie?", "answererID": "A2SSDJ77GGT3YG", "answerTime": "February 19, 2015", "helpful": [0, 0], "answerType": "?", "answerScore": "0.8380"}, {"answerText": "Yes", "answererID": "A3GSJ7UQH359Q1", "answerTime": "February 20, 2015", "helpful": [0, 0], "answerType": "Y", "answerScore": "0.9814"}]}, {"questionType": "open-ended", "askerID": "AX6YDQ92NL9B5", "questionTime": "December 22, 2014", "questionText": "Does anyone use these for Elite Dangerous? If so, how are they?", "answers": [{"answerText": "i actually do use these for Elite Dangerous and i have them set as yaw.. they work perfectly and needed no additional help or deadzone. they are spot on right out of the box.", "answererID": "A315KC8VAO3DFL", "answerTime": "December 22, 2014", "helpful": [0, 0]}, {"answerText": "Yes.  They work extremely well.", "answererID": "AZ4JNRNOM3E0J", "answerTime": "December 22, 2014", "helpful": [0, 0]}, {"answerText": "Works great with elite. Using them with assist off can be a bit tricky though.", "answererID": "A1RU4ZCFMLYY9E", "answerTime": "December 22, 2014", "helpful": [0, 0]}]}, {"questionType": "open-ended", "askerID": "A1PJ17FK3SKBDP", "questionTime": "November 21, 2014", "questionText": "I bought the it  but I don't know how to use it?", "answers": [{"answerText": "I suppose that if you buy it, you know what's it's for, that is to use with a plane simulator (the Joystick is used for pitch and roll control, and pedals for rudder/yaw control); Depending of what sort of sim. software you use, settings for this devise is generaly in the same control panel than the joystick one. On Windows you'll perhaps need to installe the drivers for it (for Mac nothing to do, as usual, it runs)", "answererID": "A16DU6Q3FA6PBF", "answerTime": "November 22, 2014", "helpful": [0, 0]}, {"answerText": "How to install into Microsoft Flight Simulator X on a computer using Microsoft Windows:  (1) plug the USB into one of the computer's USB port.  (2) Start Microsoft Flight simulator X. Fly. It should setup itself.  If the rudder does not seem to work, do #3. (3) Click Settings | Controls. Under Controller Type, select CH PRO PEDALS USB.  Click Calibration, verify the sensitivity is to your liking. Click Control Axis. Make sure it is showing Brake (left axis) as X Axis, Brake (right axis) as Y Axis, and Rudder Axis as Z Axis.Flying: The rudder peddles work the same way as they do in a real airplane, push the bottom of the peddle with the heals of your foot to move the rudder. To break, push the top of the peddles with the toes and balls of your heals.  There is no simulated wind resistance that is found in a real airplane. If you have been flying a real airplane, then using the peddles will be easy.  If you have not been flying a real airplane, then flying with the peddles will take time and practice.\n\n\n\n    How to install into Microsoft Flight Simulator X on a computer using Microsoft Windows: (1) plug the USB into one of the computer's USB port. (2) Start Microsoft Flight simulator X. Fly. It should setup itself. If the rudder does not seem to work, do #3. (3) Click Settings | Controls. Under Controller Type, select CH PRO PEDALS USB. Click Calibration, verify the sensitivity is to your liking. Click Control Axis. Make sure it is showing Brake (left axis) as X Axis, Brake (right axis) as Y Axis, and Rudder Axis as Z Axis.Flying: The rudder peddles work the same way as they do in a...\n      \u00bb \nRead More\n\n\n   How to install into Microsoft Flight Simulator X on a computer using Microsoft Windows:  (1) plug the USB into one of the computer's USB port.  (2) Start Microsoft Flight simulator X. Fly. It should setup itself.  If the rudder does not seem to work, do #3. (3) Click Settings | Controls. Under Controller Type, select CH PRO PEDALS USB.  Click Calibration, verify the sensitivity is to your liking. Click Control Axis. Make sure it is showing Brake (left axis) as X Axis, Brake (right axis) as Y Axis, and Rudder Axis as Z Axis.Flying: The rudder peddles work the same way as they do in a real airplane, push the bottom of the peddle with the heals of your foot to move the rudder. To break, push the top of the peddles with the toes and balls of your heals.  There is no simulated wind resistance that is found in a real airplane. If you have been flying a real airplane, then using the peddles will be easy.  If you have not been flying a real airplane, then flying with the peddles will take time and practice.\n      \u00ab \n\nShow Less", "answererID": "AP5G98E0BE0MC", "answerTime": "November 22, 2014", "helpful": [0, 0]}, {"answerText": "Can you elaborate? If you have Windows XP or newer it should just install automatically.", "answererID": "A2SV33RX37ZMN", "answerTime": "November 22, 2014", "helpful": [0, 0]}, {"answerText": "They are plug an play. Just plug them in to a USB port and if you're flying FSX they take over the function of turning and braking. You push down with each foot in the direction you want your plane to go, and you press down with your toes to apply brakes. It's really very simple.  If you have any further problem you may be able to find a video on Youtube or you can call the manufacturer for assistance. Good flying.", "answererID": "A2FD7DRBJB8KTZ", "answerTime": "November 23, 2014", "helpful": [0, 0]}]}, {"questionType": "open-ended", "askerID": "A2SNZWR66GW5W", "questionTime": "November 11, 2014", "questionText": "Will these work with the Saitek Yoke, Throttle Quadrant and Trim Control?", "answers": [{"answerText": "Yes, no problem", "answererID": "A27XAOZUIWZKW2", "answerTime": "November 11, 2014", "helpful": [0, 0]}, {"answerText": "That probably depends on if the game can receive inputs from three devices.", "answererID": "A2OGW5CH4V23F3", "answerTime": "November 11, 2014", "helpful": [0, 0]}, {"answerText": "The rudder pedals are independent of the yolk and throttles. They should work fine.Greg", "answererID": "A3U9UBMYCER8AJ", "answerTime": "November 11, 2014", "helpful": [0, 0]}]}]}
"""

import json

#Function to filter dataset and extract relevant fields
def filter_dataset(file_path):
    final_data = []
    with open(file_path, 'r') as file:
        for line in file:
            data = json.loads(line)
            for k,v in data.items():
                if k == 'questions':
                    for question in v:
                        question_text = question.get('questionText', '').strip()
                        question_time = question.get('questionTime', '').strip()
                        question_type = question.get('questionType', '').strip()

                        question_answers = {
                            'question_text': question_text,
                            'question_time': question_time,
                            'question_type': question_type,
                            'answers': []
                        }

                        for answer in question.get('answers', []):
                            answer_text = answer.get('answerText', '').strip()
                            answer_time = answer.get('answerTime', '').strip()
                            question_answers['answers'].append({
                                'answer_text': answer_text,
                                'answer_time': answer_time
                            })
                        final_data.append(question_answers)
    return final_data


#Save filtered data to a new JSONL file
def save_filtered_data(filtered_data, output_file_path):
    with open(output_file_path, 'w') as outfile:
        for entry in filtered_data:
            json.dump(entry, outfile)
            outfile.write('\n')

if __name__ == "__main__":
    data = filter_dataset('dataset/QA_Video_Games.jsonl')
    save_filtered_data(data, 'dataset/filtered_QA_Video_Games.jsonl')
    print(json.dumps(data[0], indent=4))